import{p as e,r as a,o as l,q as t,u as s,a as o,c as r,w as n,i as c,b as u,g as i,t as p,v as d,x as m,I as f,f as x}from"./index-02608fb8.js";import{a as h}from"./uni-app.es.79ad1943.js";import{c as g,v,a as y}from"./user.e1920ea7.js";import{_ as w}from"./_plugin-vue_export-helper.1b428a4d.js";import"./request.cf14b52c.js";const b=w({__name:"setPassWord",setup(w){const b=e(!1),_=e(0),V=e({img:"",key:""}),k=a({mobile:"",invite_mobile:"",verify:"",password:"",realPassword:"",captcha:""});h((()=>{clearInterval(globalThis.inter)})),l((()=>{j()}));const j=()=>{t({mask:!0}),g({type:"register",mobile:k.mobile}).then((({data:e})=>{V.value=e.url,s()}))},I=async()=>{if(11!==k.mobile.trim().length)return d({title:"请输入正确的手机号",icon:"none"}),!1;if(!k.captcha)return d({title:"请输入正确的算式结果",icon:"none"}),!1;try{const{data:e}=await v({mobile:k.mobile,key:V.value.key,type:"register",captch:k.captcha});b.value=!0,_.value=60,globalThis.inter=setInterval((()=>{_.value-=1,0==_.value&&clearInterval(globalThis.inter)}))}catch(e){j()}},P=async()=>{if(k.password!=k.realPassword)return d({title:"两次密码输入不匹配",icon:"none"}),!1;const e={mobile:k.mobile,password:k.password,verify:k.captcha};console.log(e),await y(e),d({title:"密码修改成功"}),setTimeout((()=>{m()}),1e3)};return(e,a)=>{const l=f,t=c,s=x;return o(),r(t,{class:"page flex-column-start-center"},{default:n((()=>[u(t,{class:"input-area flex-start-center-nowrap"},{default:n((()=>[u(l,{name:"account",class:"input flex-1",type:"text",maxlength:"11",placeholder:"手机号",modelValue:k.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>k.mobile=e)},null,8,["modelValue"]),b.value?(o(),r(t,{key:1,class:"get-code get"},{default:n((()=>[i(p(_.value)+"s",1)])),_:1})):(o(),r(t,{key:0,class:"get-code gray",onClick:I},{default:n((()=>[i("获取验证码")])),_:1}))])),_:1}),u(t,{class:"flex-start-center-nowrap"},{default:n((()=>[u(t,{class:"input-area flex-start-center-nowrap",style:{width:"384rpx"}},{default:n((()=>[u(l,{name:"account",modelValue:k.captcha,"onUpdate:modelValue":a[1]||(a[1]=e=>k.captcha=e),class:"input flex-1",type:"text",maxlength:"11",placeholder:"请输入图中算式结果"},null,8,["modelValue"])])),_:1}),u(s,{class:"verify",mode:"widthFix",src:V.value.img,onClick:j},null,8,["src"])])),_:1}),u(t,{class:"input-area flex-start-center-nowrap"},{default:n((()=>[u(l,{name:"account",class:"input flex-1",type:"text",maxlength:"11",placeholder:"验证码",modelValue:k.verify,"onUpdate:modelValue":a[2]||(a[2]=e=>k.verify=e)},null,8,["modelValue"])])),_:1}),u(t,{class:"input-area flex-start-center-nowrap"},{default:n((()=>[u(l,{name:"account",class:"input flex-1",type:"text",maxlength:"11",placeholder:"密码",modelValue:k.password,"onUpdate:modelValue":a[3]||(a[3]=e=>k.password=e)},null,8,["modelValue"])])),_:1}),u(t,{class:"input-area flex-start-center-nowrap"},{default:n((()=>[u(l,{name:"account",class:"input flex-1",type:"text",maxlength:"11",placeholder:"确定密码",modelValue:k.realPassword,"onUpdate:modelValue":a[4]||(a[4]=e=>k.realPassword=e)},null,8,["modelValue"])])),_:1}),u(t,{class:"btn",onClick:P},{default:n((()=>[i("提交")])),_:1})])),_:1})}}},[["__scopeId","data-v-c37bdfb0"]]);export{b as default};
