import{_ as e,u as a,r as l,f as t,z as s,v as r,A as n,B as i,a as c,w as o,i as u,o as m,b as p,d,t as g,h as f,j as _,F as y,e as h,x as b,p as x,y as v,C as w,k,I as V,D as j,S as $}from"./index-DV5gXwyS.js";import{_ as C,a as U,b as T}from"./show.B0O9Pu_2.js";import{_ as F,a as I,b as L}from"./plus.BTaRIcsN.js";import{a as N,o as z,b as O}from"./uni-app.es.iHn-elbW.js";import{c as P,v as R,u as S}from"./user.DOE48SVR.js";import{u as q}from"./request.8kQxyx6u.js";const A=e({__name:"registerj",setup(e){const{t:A}=a(),B=l(!1),D=l(0),E=t({nick_name:"",mobile:"",number:"",verify:"",password:"",realPassword:"",captcha:"",name:"",nation:"",certificate_type:null,real_name:"",id_number:"",certificate_image:[]}),G=l(!1);l(!1);const H=l({img:"",key:""}),J=l([]);N((e=>{var a=s("m_info");5==a.is_disabled&&(E.number=a.number,E.real_name=a.real_name,E.id_number=a.id_number)})),r((()=>{W()})),z((()=>{const{certificate_type_name:e}=s("localeList");let a=[];for(let l in e)console.log(l),a.push({key:l,name:e[l]});J.value=a,console.log(D.value,e)}));const K=e=>{E.certificate_type=e.detail.value},M=async()=>{if(!E.captcha)return b({title:A("login.register.regCaptcha"),icon:"none"}),!1;try{const{data:e}=await R({mobile:E.mobile,key:H.value.key,type:"register",captcha:E.captcha});b({title:A("login.register.sendSucess"),icon:"none"}),B.value=!0,D.value=60,globalThis.inter=setInterval((()=>{D.value-=1,0==D.value&&(clearInterval(globalThis.inter),B.value=!1)}),1e3)}catch(e){setTimeout((()=>{W()}),1e3)}};O((()=>{clearInterval(globalThis.inter)}));const Q=async()=>{let e={},a=Object.keys(s("localeList").nation),l=Object.values(s("localeList").nation);for(let s in a)e[l[s]]=a[s];let t=e[s("locale").country];if(console.log("国家id:",t,e),null==E.certificate_type)return b({title:A("login.register.pelaseCertificateType"),icon:"none"}),!1;if(0==E.real_name.length)return b({title:A("login.register.pelaseRealName"),icon:"none"}),!1;if(0==E.id_number.length)return b({title:A("login.register.pelaseIdNumber"),icon:"none"}),!1;if(0==E.certificate_image.length)return b({title:A("login.register.pelaseUploadFile"),icon:"none"}),!1;const r={mobile:E.mobile,number:E.number,password:E.password,verify:E.captcha,nation:t,name:E.nick_name,certificate_type:J.value[E.certificate_type].key,real_name:E.real_name,id_number:E.id_number,certificate_image:E.certificate_image.join(",")};return console.log(r),await S(r),x("m_info",""),b({title:A("login.registerj.success"),icon:"none",duration:3e3}),setTimeout((()=>{v({url:"/pages/login/login"})}),3e3),!1},W=()=>{n({mask:!0}),P({type:"register",mobile:E.mobile}).then((({data:e})=>{H.value=e.url,i()}))},X=()=>{w({mediaType:["image"],count:5-E.certificate_image.length,success:async e=>{console.log(e);for(let a of e.tempFilePaths){let e=await q(a);console.log(e.data),E.certificate_image.push(e.data.image_url)}}})};return(e,a)=>{const l=u,t=k,s=V,r=j,n=$;return m(),c(l,{class:"page flex-column-center-center"},{default:o((()=>[p(n,{"scroll-y":"",class:"scroll"},{default:o((()=>[p(l,{class:"title"},{default:o((()=>[d(g(e.$t("login.registerj.title")),1)])),_:1}),p(l,{class:"input-area flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:C})])),_:1}),p(s,{name:"account",class:"input flex-1",modelValue:E.number,"onUpdate:modelValue":a[0]||(a[0]=e=>E.number=e),type:"text",disabled:"",placeholder:e.$t("login.registerj.number")},null,8,["modelValue","placeholder"])])),_:1}),p(l,{class:"input-area flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:F})])),_:1}),p(s,{name:"account",class:"input flex-1",modelValue:E.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>E.mobile=e),type:"text",placeholder:e.$t("login.register.mobile")},null,8,["modelValue","placeholder"])])),_:1}),p(l,{class:"flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"input-area flex-start-center-nowrap",style:{width:"384rpx"}},{default:o((()=>[p(s,{name:"account",modelValue:E.captcha,"onUpdate:modelValue":a[2]||(a[2]=e=>E.captcha=e),class:"input flex-1",type:"text",maxlength:"11",placeholder:e.$t("login.register.captcha")},null,8,["modelValue","placeholder"])])),_:1}),p(t,{class:"verify",mode:"widthFix",src:H.value.img,onClick:W},null,8,["src"])])),_:1}),p(l,{class:"input-area flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:I})])),_:1}),p(s,{name:"account",modelValue:E.verify,"onUpdate:modelValue":a[3]||(a[3]=e=>E.verify=e),class:"input flex-1",type:"text",maxlength:"11",placeholder:e.$t("login.register.verify")},null,8,["modelValue","placeholder"]),B.value?(m(),c(l,{key:1,class:"get-code get"},{default:o((()=>[d(g(D.value)+"s",1)])),_:1})):(m(),c(l,{key:0,class:"get-code gray",onClick:M},{default:o((()=>[d(g(e.$t("login.register.getVerify")),1)])),_:1}))])),_:1}),p(l,{class:"input-area flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:U})])),_:1}),p(s,{name:"account",modelValue:E.password,"onUpdate:modelValue":a[4]||(a[4]=e=>E.password=e),class:"input flex-1",type:G.value?"text":"password",maxlength:"12",placeholder:e.$t("login.register.password")},null,8,["modelValue","type","placeholder"]),p(l,{class:"icon",onClick:a[5]||(a[5]=e=>G.value=!G.value)},{default:o((()=>[p(t,{class:"image",src:T})])),_:1})])),_:1}),p(l,{class:"input-area flex-start-center-nowrap relative"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:C})])),_:1}),p(s,{name:"account",modelValue:E.real_name,"onUpdate:modelValue":a[6]||(a[6]=e=>E.real_name=e),class:"input flex-1",type:"text",placeholder:e.$t("login.register.pelaseRealName")},null,8,["modelValue","placeholder"]),p(l,{style:{"font-size":"24rpx",position:"absolute",bottom:"-50rpx",left:"120rpx",color:"#888"}},{default:o((()=>[d(g(e.$t("login.register.real_name")),1)])),_:1})])),_:1}),p(l,{class:"input-area flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:C})])),_:1}),p(r,{class:"input flex-1",range:J.value,"range-key":"name",onChange:K},{default:o((()=>[null!=E.certificate_type?(m(),c(l,{key:0,class:"input"},{default:o((()=>[d(g(J.value[E.certificate_type].name),1)])),_:1})):(m(),c(l,{key:1,class:"input placeholder"},{default:o((()=>[d(g(e.$t("login.register.certificate_type")),1)])),_:1}))])),_:1},8,["range"])])),_:1}),p(l,{class:"input-area flex-start-center-nowrap"},{default:o((()=>[p(l,{class:"icon"},{default:o((()=>[p(t,{class:"image",src:C})])),_:1}),p(s,{name:"account",modelValue:E.id_number,"onUpdate:modelValue":a[7]||(a[7]=e=>E.id_number=e),class:"input flex-1",type:"text",placeholder:e.$t("login.register.id_number")},null,8,["modelValue","placeholder"])])),_:1}),p(l,{class:"upload-area flex-row-start-center-wrap"},{default:o((()=>[(m(!0),f(y,null,_(E.certificate_image,((e,a)=>(m(),c(t,{class:"upload",key:a,src:e,mode:"aspectFill"},null,8,["src"])))),128)),5!=E.certificate_image.length?(m(),c(l,{key:0,class:"upload flex-center-center-wrap",onClick:X},{default:o((()=>[p(t,{class:"image",src:L,mode:"widthFix"})])),_:1})):h("",!0)])),_:1}),p(l,{class:"btn",onClick:Q},{default:o((()=>[d(g(e.$t("login.register.post")),1)])),_:1}),p(l,{class:"btn line flex-center-center",onClick:a[8]||(a[8]=a=>e.toUrl("/pages/login/login"))},{default:o((()=>[d(g(e.$t("login.register.backLogin")),1)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-e6c62b97"]]);export{A as default};
